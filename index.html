<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="styles/main.css" />

    <title>Quantum Mau-Mau</title>
    <script type="module" src="src\components\Card.js"></script>
    <script type="module" src="src\components\QuantumOperationCard.js"></script>
    <script type="module" src="src\components\QuantumDestroyOperationCard.js"></script>
    <script type="module" src="src\components\MeasurementCard.js"></script>
    <script type="module" src="src\components\Hand.js"></script>
    <script type="module" src="src\components\Qubit.js"></script>
    <script type="module" src="src\components\Circuit.js"></script>
    <script type="module" src="src\components\Gate.js"></script>
    <script type="module" src="src\util\AssetFinder.js"></script>
    <script>
      function drag(ev) {
        cardType = ev.target.classList[1]
        console.log("Picked up card")
        console.log("Card Type: "+cardType)
        ev.dataTransfer.setData("cardType", cardType)
        if(cardType !== "measure") {
          gateType = ev.target.children[2].innerText
          console.log("Gate Type: "+gateType)
          ev.dataTransfer.setData("gateType", gateType)
        }
      }
      function allowDrop(ev) {
        ev.preventDefault();
      }
      function drop(ev) {
        ev.preventDefault();
        var cardType = ev.dataTransfer.getData("cardType");
        if (cardType === "measure") {
          console.log("Measurement Card Dropped. Measuring circuit after turn")
        } else {
          qubitNumber = ev.target.id
          gateType = ev.dataTransfer.getData("gateType")
          console.log(cardType + " " + gateType + " dropped on " + qubitNumber)
        }
      }


    </script>
    <script type="module">
      import Hand from "./src/components/Hand.js"
      import QuantumOperationCard from "./src/components/QuantumOperationCard.js"
      import QuantumDestroyOperationCard from "./src/components/QuantumDestroyOperationCard.js"
      import MeasurementCard from "./src/components/MeasurementCard.js"
      import Circuit from "./src/components/Circuit.js"
      import Qubit from "./src/components/Qubit.js"
      import Gate from "./src/components/Gate.js"
      
      const cards = [
        new QuantumOperationCard("hadamard"), 
        new QuantumDestroyOperationCard("cnot"), 
        new QuantumOperationCard("cnot"), 
        new QuantumOperationCard("pauli-x"), 
        new QuantumOperationCard("pauli-y"), 
        new QuantumOperationCard("pauli-z"), 
        new QuantumDestroyOperationCard("pauli-y"), 
        new MeasurementCard(),
        new QuantumDestroyOperationCard("hadamard"), 
        new QuantumDestroyOperationCard("pauli-x"), 
        new QuantumDestroyOperationCard("pauli-z"), 
      ]; 
      var hand = new Hand(cards)
      hand.render()

      var qubits = [
        new Qubit(0),
        new Qubit(1),
        new Qubit(2),
        new Qubit(3),
      ]
      var circuit = new Circuit(qubits)
      console.log(circuit)
      circuit.applyGate(new Gate("hadamard"), 0, 1)
      circuit.applyGate(new Gate("pauli-x"), 1, 0)
      circuit.applyGate(new Gate("pauli-y"), 2, 2)
      circuit.applyGate(new Gate("pauli-z"), 3, 3)
      circuit.applyGate(new Gate("hadamard"), 4, 2)
      circuit.applyGate(new Gate("measure"), 5, 0)
      circuit.applyGate(new Gate("measure"), 5, 1)
      circuit.applyGate(new Gate("measure"), 5, 2)
      circuit.applyGate(new Gate("measure"), 5, 3)
      circuit.applyCNOT(1, 3, 7)
      circuit.applyCNOT(1, 2, 8)
      circuit.applyCNOT(3, 1, 9)
      circuit.applyCNOT(3, 0, 10)
      console.log(circuit)
      circuit.render()
    </script>
  </head>
  <body>
    <div class="game-screen-container">
      <div class="draw-pile">
        <div class="card card-in-pile">
          <div>Draw Pile</div>
        </div>
      </div>
      <div class="info-container">
        <div class="scoreboard">
          <b>Scoreboard</b>
          <div class="player-info-container">
            <div id="player1-info"  class="player-info">
              <b>Player 1</b><br>
              6 Cards
            </div>
            <div id="player2-info"  class="player-info current-turn">
              <b>Player 2</b><br>
              7 Cards
            </div>
            <div id="player3-info"  class="player-info">
              <b>Player 3</b><br>
              7 Cards
            </div>
            <div id="player4-info"  class="player-info">
              <b>Bot 4</b><br>
              7 Cards
            </div>
          </div>
        </div>
        <button class="restart-game-btn">Restart Game</button>
      </div>
      <div class="player-hand">
        <div id="player-cards">
          <div class="card measure" draggable="true" ondragstart="drag(event)">
            <div class="card-title">Measure</div>
            <img src="assets/measure.png" class="card-symbol" />
            <div class="card-description">End Round</div>
          </div>
          <div class="card gate" draggable="true" ondragstart="drag(event)">
            <div class="card-title">Gate</div>
            <img src="assets/hadamard-gate.png" class="card-symbol" />
            <div class="card-description">Hadamard</div>
          </div>
          <div class="card destroy" draggable="true" ondragstart="drag(event)">
            <div class="card-title">Destroy</div>
            <img src="assets/hadamard-gate.png" class="card-symbol" />
            <div class="card-description">Hadamard</div>
          </div>
          <div class="card gate" draggable="true" ondragstart="drag(event)">
            <div class="card-title">Gate</div>
            <img src="assets/cnot-gate.png" class="card-symbol" />
            <div class="card-description">CNOT</div>
          </div>
          <div class="card destroy" draggable="true" ondragstart="drag(event)">
            <div class="card-title">Destroy</div>
            <img src="assets/cnot-gate.png" class="card-symbol" />
            <div class="card-description">CNOT</div>
          </div>
          <div class="card gate" draggable="true" ondragstart="drag(event)">
            <div class="card-title">Gate</div>
            <img src="assets/x-gate.png" class="card-symbol" />
            <div class="card-description">Pauli-X</div>
          </div>
          <div class="card destroy" draggable="true" ondragstart="drag(event)">
            <div class="card-title">Destroy</div>
            <img src="assets/x-gate.png" class="card-symbol" />
            <div class="card-description">Pauli-X</div>
          </div>
          <div class="card gate" draggable="true" ondragstart="drag(event)">
            <div class="card-title">Gate</div>
            <img src="assets/y-gate.png" class="card-symbol" />
            <div class="card-description">Pauli-Y</div>
          </div>
          <div class="card destroy" draggable="true" ondragstart="drag(event)">
            <div class="card-title">Destroy</div>
            <img src="assets/y-gate.png" class="card-symbol" />
            <div class="card-description">Pauli-Y</div>
          </div>
          <div class="card gate" draggable="true" ondragstart="drag(event)">
            <div class="card-title">Gate</div>
            <img src="assets/z-gate.png" class="card-symbol" />
            <div class="card-description">Pauli-Z</div>
          </div>
          <div class="card destroy" draggable="true" ondragstart="drag(event)">
            <div class="card-title">Destroy</div>
            <img src="assets/z-gate.png" class="card-symbol" />
            <div class="card-description">Pauli-Z</div>
          </div>

        </div>
        <button>Confirm Turn</button>
      </div>

      <div id="circuit-container">
        <div id="q0" class="qubit-row">
          <div>q[0]</div>
          <svg class="qubit-row-line" xmlns="http://www.w3.org/2000/svg" height="150%" viewBox="0 0 100 1">
            <line x1="0" y1="0.5" x2="100" y2="0.5" stroke="black" stroke-width="0.05"/>
            <image class="image" xlink:href="assets/x-gate.png" x="12.5" y="-12" width="2" height="25" />
          </svg>
        </div>
        <div id="q1" class="qubit-row">
          <div>q[1]</div>
          <svg class="qubit-row-line" xmlns="http://www.w3.org/2000/svg" height="150%" viewBox="0 0 100 1">
            <line x1="0" y1="0.5" x2="100" y2="0.5" stroke="black" stroke-width="0.05"/>
            <image class="image" xlink:href="assets/z-gate.png" x="0.5" y="-12" width="2" height="25" />
            <image class="image" xlink:href="assets/hadamard-gate.png" x="6.5" y="-12" width="2" height="25" />
            <image class="image" xlink:href="assets/cnot-c.png" x="9.5" y="-7.5" width="2" height="20" />
          </svg>
        </div>
        <div id="q2" class="qubit-row">
          <div>q[2]</div>
          <svg class="qubit-row-line" xmlns="http://www.w3.org/2000/svg" height="150%" viewBox="0 0 100 1">
            <line x1="0" y1="0.5" x2="100" y2="0.5" stroke="black" stroke-width="0.05"/>
            <image class="image" xlink:href="assets/y-gate.png" x="3.5" y="-12" width="2" height="25" />
            <image class="image" xlink:href="assets/cnot-middle.png" x="9.5" y="-12" width="2" height="25" />
            <image class="image" xlink:href="assets/cnot-not-flipped.png" x="15.5" y="-10.3" width="2" height="25" />
          </svg>
        </div>
        <div id="q3" class="qubit-row">
          <div>q[3]</div>
          <svg class="qubit-row-line" xmlns="http://www.w3.org/2000/svg" height="150%" viewBox="0 0 100 1">
            <line x1="0" y1="0.5" x2="100" y2="0.5" stroke="black" stroke-width="0.05"/>
            <image class="image" xlink:href="assets/cnot-not.png" x="9.5" y="-13.7" width="2" height="25" />
            <image class="image" xlink:href="assets/cnot-c-flipped.png" x="15.5" y="-13.9" width="2" height="25" />
          </svg>
        </div>
      </div>
    </div>
  </body>
</html>
